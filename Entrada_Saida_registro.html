<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Registro de Veículos</title>
    <link rel="icon" href="imagens/icone.png" type="image/png"/>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            background-color: #f8f9fa;
        }
        .tabcontent {
            display: none;
            padding: 20px;
            border-top: none;
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            padding: 12px;
            text-align: left;
        }
        .btn-custom {
            margin: 5px;
        }
    </style>
</head>
<body>
    <div class="container mt-5">
        <h1 class="text-center">
            <img src="imagens/logo.png" alt="Ícone" style="width: 100px; height: 100px;">
            Registro de Veículos
        </h1>

        <div class="text-center my-4">
            <button class="btn btn-primary btn-custom" onclick="openTab('Entrada')">Entrada</button>
            <button class="btn btn-primary btn-custom" onclick="openTab('Saida')">Saída</button>
            <button class="btn btn-primary btn-custom" onclick="openTab('Consolidado')">Tabela Controle</button>
        </div>

        <div id="Entrada" class="tabcontent">
            <h2>Registro de Entrada de Veículos</h2>
            <form id="registroEntradaForm">
                <div class="form-group">
                    <label for="placaEntrada">Placa do Carro:</label>
                    <input type="text" class="form-control" id="placaEntrada" required>
                </div>
                <div class="form-group">
                    <label for="dataEntrada">Data de Entrada:</label>
                    <input type="date" class="form-control" id="dataEntrada" required>
                </div>
                <div class="form-group">
                    <label for="horaEntrada">Hora de Entrada:</label>
                    <input type="time" class="form-control" id="horaEntrada" required>
                </div>
                <div class="form-group">
                    <label for="motoristaEntrada">Motorista:</label>
                    <input type="text" class="form-control" id="motoristaEntrada" required>
                </div>
                <div class="form-group">
                    <label for="empresaEntrada">Empresa:</label>
                    <input type="text" class="form-control" id="empresaEntrada" required>
                </div>
                <button type="button" class="btn btn-success" onclick="registrarEntrada()">Registrar Entrada</button>
            </form>
            <h2 class="mt-4">Entradas Registradas</h2>
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th>Placa do Carro</th>
                        <th>Data de Entrada</th>
                        <th>Hora de Entrada</th>
                        <th>Motorista</th>
                        <th>Empresa</th>
                    </tr>
                </thead>
                <tbody id="tabelaEntradas">
                </tbody>
            </table>
        </div>

        <div id="Saida" class="tabcontent">
            <h2>Registro de Saída de Veículos</h2>
            <form id="registroSaidaForm">
                <div class="form-group">
                    <label for="placaSaida">Placa do Carro:</label>
                    <input type="text" class="form-control" id="placaSaida" required>
                </div>
                <div class="form-group">
                    <label for="dataSaida">Data de Saída:</label>
                    <input type="date" class="form-control" id="dataSaida" required>
                </div>
                <div class="form-group">
                    <label for="horaSaida">Hora de Saída:</label>
                    <input type="time" class="form-control" id="horaSaida" required>
                </div>
                <div class="form-group">
                    <label for="motoristaSaida">Motorista:</label>
                    <input type="text" class="form-control" id="motoristaSaida" required>
                </div>
                <div class="form-group">
                    <label for="empresaSaida">Empresa:</label>
                    <input type="text" class="form-control" id="empresaSaida" required>
                </div>
                <button type="button" class="btn btn-success" onclick="registrarSaida()">Registrar Saída</button>
            </form>
            <h2 class="mt-4">Saídas Registradas</h2>
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th>Placa do Carro</th>
                        <th>Data de Saída</th>
                        <th>Hora de Saída</th>
                        <th>Motorista</th>
                        <th>Empresa</th>
                    </tr>
                </thead>
                <tbody id="tabelaSaidas">
                </tbody>
            </table>
        </div>

        <div id="Consolidado" class="tabcontent">
            <h2>Registro Consolidado de Veículos</h2>
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th>Tipo</th>
                        <th>Placa do Carro</th>
                        <th>Data</th>
                        <th>Hora</th>
                        <th>Motorista</th>
                        <th>Empresa</th>
                    </tr>
                </thead>
                <tbody id="tabelaConsolidada">
                </tbody>
            </table>
            <div class="text-center my-4">
                <button class="btn btn-info" onclick="baixarPlanilha()">Salvar Planilha</button>
            </div>
        </div>
    </div>

    <script>
        function openTab(tabName) {
            var i, tabcontent;
            tabcontent = document.getElementsByClassName("tabcontent");
            for (i = 0; i < tabcontent.length; i++) {
                tabcontent[i].style.display = "none";
            }
            document.getElementById(tabName).style.display = "block";
        }

        function carregarDados() {
            const tabelaConsolidada = document.getElementById('tabelaConsolidada');
            tabelaConsolidada.innerHTML = ''; // Limpa a tabela antes de recarregar os dados

            const entradas = JSON.parse(localStorage.getItem('entradas')) || [];
            const saidas = JSON.parse(localStorage.getItem('saidas')) || [];

            entradas.forEach(entrada => {
                const novaLinha = tabelaConsolidada.insertRow();
                novaLinha.insertCell(0).textContent = 'Entrada';
                novaLinha.insertCell(1).textContent = entrada.placa;
                novaLinha.insertCell(2).textContent = entrada.data;
                novaLinha.insertCell(3).textContent = entrada.hora;
                novaLinha.insertCell(4).textContent = entrada.motorista;
                novaLinha.insertCell(5).textContent = entrada.empresa;
            });

            saidas.forEach(saida => {
                const novaLinha = tabelaConsolidada.insertRow();
                novaLinha.insertCell(0).textContent = 'Saída';
                novaLinha.insertCell(1).textContent = saida.placa;
                novaLinha.insertCell(2).textContent = saida.data;
                novaLinha.insertCell(3).textContent = saida.hora;
                novaLinha.insertCell(4).textContent = saida.motorista;
                novaLinha.insertCell(5).textContent = saida.empresa;
            });
        }

        window.onload = function() {
            openTab('Entrada');
            carregarDados();
        };
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.9/xlsx.full.min.js"></script>
    <script src="registro_veiculo.js"></script>
</body>
</html>